# FASE 5 - System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          GALAXY PARLAY V3.0                             â”‚
â”‚                    FASE 5: Smart Parlay + League Cal ibration           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FRONTEND (Next.js)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Match Cards    â”‚  â”‚  Parlay Builder â”‚  â”‚  Value Bets     â”‚        â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚        â”‚
â”‚  â”‚  â€¢ Predictions  â”‚  â”‚  â€¢ Add markets  â”‚  â”‚  â€¢ Top picks    â”‚        â”‚
â”‚  â”‚  â€¢ Odds display â”‚  â”‚  â€¢ Validation   â”‚  â”‚  â€¢ EV > 5%      â”‚        â”‚
â”‚  â”‚  â€¢ â­ Premium   â”‚  â”‚  â€¢ âš ï¸ Warnings  â”‚  â”‚  â€¢ Kelly sizing â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚ HTTP/REST
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND API (FastAPI)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                    Galaxy API Routes                      â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  GET  /fixtures                 - List with predictions   â”‚          â”‚
â”‚  â”‚  GET  /fixtures/:id             - Detailed analysis       â”‚          â”‚
â”‚  â”‚  GET  /predictions              - Top picks               â”‚          â”‚
â”‚  â”‚  GET  /value-bets               - Value opportunities     â”‚          â”‚
â”‚  â”‚  GET  /match-analysis/:id       - Comprehensive analysis  â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  ðŸ†• POST /parlay/validate        - Validate parlay       â”‚          â”‚
â”‚  â”‚  ðŸ†• GET  /parlay/recommendations - Smart suggestions     â”‚          â”‚
â”‚  â”‚  ðŸ†• GET  /parlay/correlation     - Matrix data           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                â”‚                 â”‚
                   â”‚                â”‚                 â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Prediction Models  â”‚ â”‚  Value    â”‚ â”‚  Smart Parlay â”‚
      â”‚                     â”‚ â”‚  Detector â”‚ â”‚  Validator    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ML PREDICTION LAYER                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚               Dixon-Coles Model v3.0 (ENHANCED)           â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  â€¢ Bivariate Poisson prediction                           â”‚          â”‚
â”‚  â”‚  â€¢ Decay factor: 0.003                                    â”‚          â”‚
â”‚  â”‚  â€¢ ðŸ†• League-specific home advantage:                     â”‚          â”‚
â”‚  â”‚    - Champions League: 0.35 (+0.08 boost)                â”‚          â”‚
â”‚  â”‚    - Bundesliga: 0.35 (+0.08 boost)                      â”‚          â”‚
â”‚  â”‚    - La Liga: 0.27 (optimal)                             â”‚          â”‚
â”‚  â”‚  â€¢ European competition adjustment: -10%                  â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  Input: team_ids, league_id, is_european                 â”‚          â”‚
â”‚  â”‚  Output: probabilities for 9 markets                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚            Multi-Market Predictor v2.0 (ENHANCED)         â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  â€¢ Corners, cards, shots prediction                       â”‚          â”‚
â”‚  â”‚  â€¢ ðŸ†• League-specific goals multiplier:                   â”‚          â”‚
â”‚  â”‚    - Champions League: 1.20 (+0.05 boost)                â”‚          â”‚
â”‚  â”‚    - Bundesliga: 1.20 (+0.05 boost)                      â”‚          â”‚
â”‚  â”‚    - La Liga: 1.15 (optimal)                             â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  Input: fixture, team_stats, league_id                   â”‚          â”‚
â”‚  â”‚  Output: predictions for 16+ markets                      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                    ðŸ†• Smart Parlay Validator              â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  â€¢ Correlation-based validation                           â”‚          â”‚
â”‚  â”‚  â€¢ Thresholds:                                            â”‚          â”‚
â”‚  â”‚    - HIGH (>0.70): REJECT parlay                          â”‚          â”‚
â”‚  â”‚    - MODERATE (0.30-0.70): WARN + 5% penalty             â”‚          â”‚
â”‚  â”‚    - LOW (<0.30): APPROVE                                â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  Known Correlations (FASE 5 Analysis):                   â”‚          â”‚
â”‚  â”‚    - Over 2.5 â†” Over 3.5: r=0.681 (REJECT)              â”‚          â”‚
â”‚  â”‚    - Over 2.5 â†” Over 1.5: r=0.580 (WARN)                â”‚          â”‚
â”‚  â”‚    - Home Win â†” Over 1.5: r=-0.021 (APPROVE)            â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  Input: market selections (same fixture)                 â”‚          â”‚
â”‚  â”‚  Output: validation status, penalty, recommendations      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                    ðŸ†• League Configuration                â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  LEAGUE_HOME_ADVANTAGE = {                                â”‚          â”‚
â”‚  â”‚    2: (0.35, 1.20),    # Champions League (BOOSTED)      â”‚          â”‚
â”‚  â”‚    78: (0.35, 1.20),   # Bundesliga (BOOSTED)            â”‚          â”‚
â”‚  â”‚    140: (0.27, 1.15),  # La Liga (OPTIMAL)               â”‚          â”‚
â”‚  â”‚    ... 21 more leagues                                    â”‚          â”‚
â”‚  â”‚  }                                                         â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  PREMIUM_MARKETS = {                                      â”‚          â”‚
â”‚  â”‚    "over_under_1_5": 79.90%,  # â­ Best performer        â”‚          â”‚
â”‚  â”‚  }                                                         â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  HIGH_CORRELATION_PAIRS = {                               â”‚          â”‚
â”‚  â”‚    ("over_2_5", "over_3_5"): 0.681,                      â”‚          â”‚
â”‚  â”‚    ... 44 more pairs                                      â”‚          â”‚
â”‚  â”‚  }                                                         â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DATA & STORAGE LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   Supabase DB        â”‚  â”‚   API-Football       â”‚                    â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚                    â”‚
â”‚  â”‚  â€¢ fixtures          â”‚  â”‚  â€¢ Real-time data    â”‚                    â”‚
â”‚  â”‚  â€¢ predictions       â”‚  â”‚  â€¢ Historical data   â”‚                    â”‚
â”‚  â”‚  â€¢ odds_snapshots    â”‚  â”‚  â€¢ Team statistics   â”‚                    â”‚
â”‚  â”‚  â€¢ quality_scores    â”‚  â”‚  â€¢ Fixtures & odds   â”‚                    â”‚
â”‚  â”‚  â€¢ team_elo_ratings  â”‚  â”‚                      â”‚                    â”‚
â”‚  â”‚  â€¢ team_statistics   â”‚  â”‚  Rate Limit:         â”‚                    â”‚
â”‚  â”‚                      â”‚  â”‚  7,500 req/day       â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   Dixon-Coles Cache  â”‚  â”‚   Prediction Cache   â”‚                    â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚                    â”‚
â”‚  â”‚  â€¢ Fitted model      â”‚  â”‚  â€¢ Recent predictionsâ”‚                    â”‚
â”‚  â”‚  â€¢ Attack/defense    â”‚  â”‚  â€¢ Quality scores    â”‚                    â”‚
â”‚  â”‚    parameters        â”‚  â”‚  â€¢ Confidence levels â”‚                    â”‚
â”‚  â”‚  â€¢ 184 teams         â”‚  â”‚                      â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BACKTESTING & ANALYSIS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                   Backtesting Framework                   â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  â€¢ Historical fixture replay                              â”‚          â”‚
â”‚  â”‚  â€¢ Multi-model comparison (old vs new)                   â”‚          â”‚
â”‚  â”‚  â€¢ Per-league analysis                                    â”‚          â”‚
â”‚  â”‚  â€¢ Per-market accuracy tracking                           â”‚          â”‚
â”‚  â”‚  â€¢ Correlation matrix calculation                         â”‚          â”‚
â”‚  â”‚  â€¢ Brier score, log loss metrics                          â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  Recent Results (FASE 5 Baseline):                       â”‚          â”‚
â”‚  â”‚  â€¢ Dataset: 1,000 fixtures, 16,506 predictions           â”‚          â”‚
â”‚  â”‚  â€¢ Overall: 72.18% accuracy                               â”‚          â”‚
â”‚  â”‚  â€¢ Champions League: 63.89% (needs improvement)          â”‚          â”‚
â”‚  â”‚  â€¢ Bundesliga: 68.50% (needs improvement)                â”‚          â”‚
â”‚  â”‚  â€¢ La Liga: 74.81% (excellent)                            â”‚          â”‚
â”‚  â”‚  â€¢ Over/Under 1.5: 79.90% (best market)                  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DEPLOYMENT & MONITORING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   Railway (Worker)   â”‚  â”‚   Vercel (Frontend)  â”‚                    â”‚
â”‚  â”‚                      â”‚  â”‚                      â”‚                    â”‚
â”‚  â”‚  â€¢ Python backend    â”‚  â”‚  â€¢ Next.js app       â”‚                    â”‚
â”‚  â”‚  â€¢ FastAPI server    â”‚  â”‚  â€¢ Static export     â”‚                    â”‚
â”‚  â”‚  â€¢ Prediction jobs   â”‚  â”‚  â€¢ Edge functions    â”‚                    â”‚
â”‚  â”‚  â€¢ Data population   â”‚  â”‚  â€¢ CDN delivery      â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚                    Monitoring & Logs                      â”‚          â”‚
â”‚  â”‚                                                            â”‚          â”‚
â”‚  â”‚  â€¢ Structlog for structured logging                       â”‚          â”‚
â”‚  â”‚  â€¢ API request tracking                                   â”‚          â”‚
â”‚  â”‚  â€¢ Model performance metrics                              â”‚          â”‚
â”‚  â”‚  â€¢ Error tracking and alerts                              â”‚          â”‚
â”‚  â”‚  â€¢ User behavior analytics                                â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            DATA FLOW EXAMPLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. USER REQUEST: "Validate my parlay: Over 2.5 + Home Win on Arsenal vs Liverpool"
   â”‚
   â”œâ”€â†’ POST /api/parlay/validate
   â”‚   Body: {
   â”‚     "selections": [
   â”‚       {"fixture_id": 123, "market_key": "over_under_2_5_over", ...},
   â”‚       {"fixture_id": 123, "market_key": "match_winner_home_win", ...}
   â”‚     ]
   â”‚   }
   â”‚
   â”œâ”€â†’ Smart Parlay Validator
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Check same fixture? YES
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Lookup correlation: over_2_5 â†” home_win
   â”‚   â”‚   Result: r=0.120 (LOW)
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Validation: APPROVED
   â”‚       Penalty: 1.0 (no reduction)
   â”‚       Reason: "âœ… Valid parlay combination"
   â”‚
   â””â”€â†’ RESPONSE: {
       "valid": true,
       "reason": "âœ… Valid parlay combination",
       "odds_penalty": 1.0,
       "original_odds": 2.96,
       "adjusted_odds": 2.96,
       "expected_value": 0.0421,
       "recommendation": "GOOD_VALUE"
     }

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

2. USER REQUEST: "Show me Arsenal vs Liverpool predictions"
   â”‚
   â”œâ”€â†’ GET /match-analysis/123
   â”‚
   â”œâ”€â†’ Database: Get fixture, teams, odds
   â”‚
   â”œâ”€â†’ Dixon-Coles Model
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Get league_id: 39 (Premier League)
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Load league config: home_advantage = 0.27, goals = 1.15
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Predict match:
   â”‚       - Home Win: 0.68 (68%)
   â”‚       - Draw: 0.20 (20%)
   â”‚       - Away Win: 0.12 (12%)
   â”‚       - Over 2.5: 0.62 (62%)
   â”‚       - BTTS: 0.55 (55%)
   â”‚
   â”œâ”€â†’ Multi-Market Predictor
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Calculate xG with league multiplier: 1.15
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Predict:
   â”‚       - Corners Over 9.5: 0.71 (71%)
   â”‚       - Cards Over 3.5: 0.58 (58%)
   â”‚
   â”œâ”€â†’ Value Detector
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Compare with bookmaker odds
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Find value bets:
   â”‚       - Home Win: 1.60 vs 0.68 prob â†’ Edge: 5.8%
   â”‚
   â”œâ”€â†’ Smart Parlay Recommendations
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Get available markets: 9 markets
   â”‚   â”‚
   â”‚   â”œâ”€â†’ Find low-correlation pairs:
   â”‚       1. Home Win + Over 1.5 (r=-0.021)
   â”‚       2. Home Win + Corners O9.5 (r=0.08)
   â”‚
   â””â”€â†’ RESPONSE: Complete analysis with predictions, value bets, parlays

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          VERSION HISTORY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

v1.0 (FASE 1-2) - Basic Predictions
  â€¢ Elo ratings
  â€¢ Dixon-Coles basic
  â€¢ Simple 1X2 predictions

v2.0 (FASE 3-4) - Enhanced Models
  â€¢ Multi-market predictions (16+ markets)
  â€¢ Kelly criterion bet sizing
  â€¢ Value bet detection
  â€¢ Quality scoring system
  â€¢ Competition-aware adjustments

v3.0 (FASE 5) - Smart Intelligence â­ CURRENT
  â€¢ ðŸ†• League-specific calibration (24 leagues)
  â€¢ ðŸ†• Smart Parlay correlation filter
  â€¢ ðŸ†• Market confidence system
  â€¢ ðŸ†• Premium market labeling
  â€¢ Enhanced prediction accuracy: 72.18% â†’ 73-74%

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
